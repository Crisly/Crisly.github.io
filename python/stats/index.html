<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Python data analysis & visualisation</title> <link rel="stylesheet" href="http://localhost:4000/assets/css/styles_feeling_responsive.css"> <script src="http://localhost:4000/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic|Volkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="Vk0IOJ2jwG_qEoG7fuEXYqv0m2rLa8P778Fi_GrsgEQ" /> <meta name="description" content="»Crisly&#39;s antics« is my personal webspace. About neuroscience, tinnitus, photos and more."/> <link rel="author" href="https://plus.google.com/u/0/104027836769579186358"/> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:title" content="Python data analysis & visualisation" /> <meta property="og:description" content="»Crisly&#39;s antics« is my personal webspace. About neuroscience, tinnitus, photos and more."/> <meta property="og:url" content="http://localhost:4000//python/stats/" /> <meta property="og:site_name" content="" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="http://localhost:4000/humans.txt" /> </head> <body id="top-of-page" class="post"> <div id="navigation" class="sticky"> <nav class="top-bar" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="show-for-small-only"><a href="http://localhost:4000" class="icon-tree"> </a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></li> </ul> <section class="top-bar-section"> <ul class="right"> <li class="divider"></li> <li><a href="http://localhost:4000/search/">Search</a></li> <li class="divider"></li> <li><a href="http://localhost:4000/contact/">Contact</a></li> </ul> <ul class="left"> <li><a href="http://localhost:4000/">Home</a></li> <li class="divider"></li> <li class="has-dropdown"> <a href="http://localhost:4000/blog/">Blog</a> <ul class="dropdown"> <li><a href="http://localhost:4000/general/">General</a></li> <li><a href="http://localhost:4000/music/">Music</a></li> <li><a href="http://localhost:4000/blog/archive/">Blog Archive</a></li> </ul> </li> <li class="divider"></li> <li><a href="http://localhost:4000/photos/">Photos</a></li> <li class="divider"></li> <li><a href="http://localhost:4000/resume/">Resume</a></li> <li class="divider"></li> </ul> </section> </nav> </div><!-- /#navigation --> <div id="masthead"> <div class="row"> <div class="small-12 columns"> <a id="logo" href="http://localhost:4000" title=" – "> <img src="http://localhost:4000/assets/img/" alt=" – "> </a> </div><!-- /.small-12.columns --> </div><!-- /.row --> </div><!-- /#masthead --> <nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs"> <li><a href="http://localhost:4000">Start</a></li> <li><a href="http://localhost:4000/python/">python</a> <li class="current">Python data analysis & visualisation</li> </nav> <div class="masthead-caption"> Crosscombe, Cornwall, UK </div> <div class="row t30"> <div class="medium-8 columns medium-offset-2 end"> <article itemscope itemtype="http://schema.org/Article"> <header> <span itemprop="name"> <p class="subheadline">Or do stats using python</p> <h1>Python data analysis & visualisation</h1> </span> </header> <span itemprop="articleSection"> <p><strong>In [109]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span> <span class="kn">as</span> <span class="nn">op</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="c"># some, perhaps, relevant links:</span>
<span class="c"># http://stats.stackexchange.com/questions/24314/when-is-a-repeated-measures-anova-preferred-over-a-mixed-effects-model</span>
<span class="c"># http://nbviewer.ipython.org/urls/umich.box.com/shared/static/6tfc1e0q6jincsv5pgfa.ipynb</span>
<span class="c"># http://jpktd.blogspot.jp/2013/03/multiple-comparison-and-tukey-hsd-or_25.html</span>
<span class="c"># http://statsmodels.sourceforge.net/devel/anova.html</span>

<span class="n">resdir</span> <span class="o">=</span> <span class="s">&#39;/Users/cplanting/ABR-vis/&#39;</span>
<span class="n">data_bera</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">resdir</span><span class="p">,</span><span class="s">&#39;amp.csv&#39;</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span> <span class="n">data_bera</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c">#g0 = sns.factorplot(&quot;intensity&quot;,&quot;amplitude&quot;,&quot;stimulus_type&quot;,kind=&quot;auto&quot;,</span>
<span class="c">#                    ci=90,n_boot=5000, estimator=np.mean, </span>
<span class="c">#                    data=data_bera, size=6, palette=&quot;muted&quot;)</span>

<span class="c">#g1 = sns.factorplot(&quot;intensity&quot;,&quot;amplitude&quot;,&quot;ear&quot;,kind=&quot;auto&quot;,</span>
<span class="c">#                    ci=90,n_boot=5000, estimator=np.mean, </span>
<span class="c">#                    data=data_bera, size=6, palette=&quot;muted&quot;)</span>

<span class="c">#g2 = sns.factorplot(&quot;stimulus_type&quot;,&quot;amplitude&quot;,&quot;stimulus_type&quot;,kind=&quot;auto&quot;,</span>
<span class="c">#                    ci=90,n_boot=5000, estimator=np.mean, </span>
<span class="c">#                    data=data_bera, size=6, palette=&quot;muted&quot;)</span>

<span class="c">#bin data: http://stackoverflow.com/questions/16947336/binning-a-dataframe-in-pandas-in-python</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">int_binned</span> <span class="o">=</span> <span class="n">data_bera</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">data_bera</span><span class="o">.</span><span class="n">intensity</span><span class="p">,</span> <span class="n">bins</span><span class="p">))</span>
<span class="c">#print data_bera.head()</span>
<span class="c">#print int_binned.head()</span>
<span class="k">def</span> <span class="nf">int_round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mult</span><span class="p">):</span>
    <span class="c">#round to closest multiple of 10; 5.0 -&gt; 0.0; 5.1 -&gt; 10.0</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">mult</span><span class="p">)</span> <span class="o">*</span> <span class="n">mult</span>

<span class="n">data_bera</span><span class="p">[</span><span class="s">&#39;intensity (dB SPL)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_round</span><span class="p">(</span><span class="n">data_bera</span><span class="p">[</span><span class="s">&#39;intensity&#39;</span><span class="p">],</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">data_bera</span><span class="p">[</span><span class="n">data_bera</span><span class="o">.</span><span class="n">intensity</span> <span class="o">&lt;=</span> <span class="mi">85</span><span class="p">]</span>
<span class="n">g0</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">factorplot</span><span class="p">(</span><span class="s">&quot;intensity (dB SPL)&quot;</span><span class="p">,</span><span class="s">&quot;amplitude&quot;</span><span class="p">,</span><span class="s">&quot;stimulus_type&quot;</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">&quot;auto&quot;</span><span class="p">,</span>
                    <span class="n">ci</span><span class="o">=</span><span class="mi">68</span><span class="p">,</span><span class="n">n_boot</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">estimator</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> 
                    <span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">&quot;muted&quot;</span><span class="p">)</span>

<span class="k">print</span> <span class="n">int_binned</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span></code></pre></div><pre><code>   sub_id  intensity initials     ear stimulus_type  latency  amplitude
0       1         80       JM  Rechts         Chirp     5.77        620
1       1         80       JM  Rechts        Clicks     5.57        450
2       1         80       JM   Links         Chirp     5.57        725
3       1         80       JM   Links        Clicks     5.73        500
4       1         70       JM  Rechts        Clicks     5.93        475
             sub_id  intensity   latency   amplitude  intensity (dB SPL)
intensity                                                               
(5, 15]    7.000000  10.312500  9.108125  227.500000           10.625000
(15, 25]   8.333333  20.138889  8.243056  331.944444           20.000000
(25, 35]   7.846154  30.384615  7.881282  395.512821           30.769231
(35, 45]   7.666667  40.294118  7.636863  465.588235           40.000000
(45, 55]   8.535714  50.178571  7.559643  360.357143           50.357143
(55, 65]   8.020833  60.000000  6.584792  554.375000           60.000000
(65, 75]   8.230769  70.000000  6.545385  535.192308           70.000000
(75, 85]   7.325581  80.000000  5.897209  658.139535           80.000000
</code></pre><p><img src="notebooks/stats_bera_files/stats_bera_0_1.png" alt="png" /></p> <p><strong>In [110]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#amp_mean = data_bera.groupby([&#39;intensity&#39;, &#39;stimulus_type&#39;]).aggregate(np.mean)</span>
<span class="c">#print amp_mean</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;stimulus_type&#39;</span><span class="p">]):</span>
    <span class="c">#print group</span>
    <span class="n">group_agg</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;intensity (dB SPL)&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
    <span class="n">group_agg_err</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;intensity (dB SPL)&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
    <span class="n">group_agg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">&#39;latency&#39;</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">group_agg_err</span><span class="p">)</span>
    <span class="c">#error bars do not appear yet...</span></code></pre></div> <p><img src="notebooks/stats_bera_files/stats_bera_1_0.png" alt="png" /></p> <p><strong>In [111]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;stimulus_type&#39;</span><span class="p">,</span><span class="s">&#39;intensity (dB SPL)&#39;</span><span class="p">])[</span><span class="s">&#39;amplitude&#39;</span><span class="p">]</span>
<span class="c">#df = tmp.groupby([&#39;intensity (dB SPL)&#39;,&#39;stimulus_type&#39;])[&#39;latency&#39;]</span>
<span class="c">#df.mean()</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c">#take standard error of the mean instead of standard deviation.</span>
<span class="n">errors</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="k">print</span> <span class="n">means</span><span class="p">,</span><span class="n">errors</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">means</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yerr</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">&#39;bar&#39;</span><span class="p">)</span></code></pre></div><pre><code>stimulus_type  intensity (dB SPL)
Chirp          0                     172.500000
               10                    241.250000
               20                    412.500000
               30                    495.555556
               40                    514.827586
               50                    414.285714
               60                    660.208333
               70                    698.000000
               80                    753.750000
Clicks         10                    190.000000
               20                    247.368421
               30                    337.222222
               40                    370.000000
               50                    317.307692
               60                    437.200000
               70                    433.437500
               80                    575.000000
Name: amplitude, dtype: float64 stimulus_type  intensity (dB SPL)
Chirp          0                     16.404806
               10                    21.182458
               20                    33.413758
               30                    57.923839
               40                    65.140026
               50                    56.743962
               60                    75.148173
               70                    77.826269
               80                    58.781322
Clicks         10                     2.425356
               20                    19.467454
               30                    27.177560
               40                    43.940412
               50                    36.953917
               60                    47.626354
               70                    40.621927
               80                    49.375783
Name: amplitude, dtype: float64





&lt;matplotlib.axes.AxesSubplot at 0x10db6b110&gt;
</code></pre><p><img src="notebooks/stats_bera_files/stats_bera_2_2.png" alt="png" /></p> <p><strong>In [112]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#amp_mean = data_bera.groupby([&#39;intensity&#39;, &#39;stimulus_type&#39;]).aggregate(np.mean)</span>
<span class="c">#print amp_mean</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;stimulus_type&#39;</span><span class="p">]):</span>
    <span class="c">#print group</span>
    <span class="n">group_agg</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;intensity (dB SPL)&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
    <span class="n">group_agg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">&#39;amplitude&#39;</span><span class="p">)</span></code></pre></div> <p><img src="notebooks/stats_bera_files/stats_bera_3_0.png" alt="png" /></p> <p><strong>In [113]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#df = tmp.groupby([&#39;stimulus_type&#39;,&#39;intensity_bin&#39;])[&#39;amplitude&#39;]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;intensity (dB SPL)&#39;</span><span class="p">,</span><span class="s">&#39;stimulus_type&#39;</span><span class="p">])[</span><span class="s">&#39;amplitude&#39;</span><span class="p">]</span>
<span class="c">#df.mean()</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c">#take standard error of the mean instead of plain std.</span>
<span class="n">errors</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="k">print</span> <span class="n">means</span><span class="p">,</span><span class="n">errors</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">means</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yerr</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">&#39;bar&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">])</span></code></pre></div><pre><code>intensity (dB SPL)  stimulus_type
0                   Chirp            172.500000
10                  Chirp            241.250000
                    Clicks           190.000000
20                  Chirp            412.500000
                    Clicks           247.368421
30                  Chirp            495.555556
                    Clicks           337.222222
40                  Chirp            514.827586
                    Clicks           370.000000
50                  Chirp            414.285714
                    Clicks           317.307692
60                  Chirp            660.208333
                    Clicks           437.200000
70                  Chirp            698.000000
                    Clicks           433.437500
80                  Chirp            753.750000
                    Clicks           575.000000
Name: amplitude, dtype: float64 intensity (dB SPL)  stimulus_type
0                   Chirp            16.404806
10                  Chirp            21.182458
                    Clicks            2.425356
20                  Chirp            33.413758
                    Clicks           19.467454
30                  Chirp            57.923839
                    Clicks           27.177560
40                  Chirp            65.140026
                    Clicks           43.940412
50                  Chirp            56.743962
                    Clicks           36.953917
60                  Chirp            75.148173
                    Clicks           47.626354
70                  Chirp            77.826269
                    Clicks           40.621927
80                  Chirp            58.781322
                    Clicks           49.375783
Name: amplitude, dtype: float64





&lt;matplotlib.axes.AxesSubplot at 0x10dbc4890&gt;
</code></pre><p><img src="notebooks/stats_bera_files/stats_bera_4_2.png" alt="png" /></p> <p><strong>In [114]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">print</span> <span class="n">means</span><span class="p">[</span><span class="s">&#39;stimulus_type&#39;</span><span class="o">==</span><span class="s">&#39;Clicks&#39;</span><span class="p">]</span>
<span class="c">#overall mean? check!</span></code></pre></div><pre><code>stimulus_type
Chirp            172.5
Name: amplitude, dtype: float64
</code></pre><p><strong>In [115]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">MixedLM</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s">&quot;amplitude ~ intensity * stimulus_type&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="n">tmp</span><span class="p">[</span><span class="s">&quot;sub_id&quot;</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span> <span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span></code></pre></div><pre><code>                       Mixed Linear Model Regression Results
==================================================================================
Model:                      MixedLM         Dependent Variable:         amplitude 
No. Observations:           291             Method:                     REML      
No. Groups:                 16              Scale:                      15421.7194
Min. group size:            3               Likelihood:                 -1834.6913
Max. group size:            29              Converged:                  Yes       
Mean group size:            18.2                                                  
----------------------------------------------------------------------------------
                                    Coef.   Std.Err.   z    P&gt;|z|  [0.025   0.975]
----------------------------------------------------------------------------------
Intercept                            95.938   53.345  1.798 0.072   -8.616 200.492
stimulus_type[T.Clicks]            -108.567   35.500 -3.058 0.002 -178.145 -38.989
intensity                             8.538    0.471 18.112 0.000    7.614   9.462
intensity:stimulus_type[T.Clicks]    -1.245    0.683 -1.824 0.068   -2.584   0.093
Intercept RE                      36195.683  117.297                              
==================================================================================
</code></pre><p><strong>In [116]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">model_anova</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s">&#39;amplitude ~ stimulus_type*intensity&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">tmp</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">anova_lm</span><span class="p">(</span><span class="n">model_anova</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c"># Type 2 ANOVA DataFrame</span>
<span class="k">print</span> <span class="n">model_anova</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="k">print</span> <span class="n">table</span>

<span class="c">#interestingly, by using plain ANOVA (without repeated measures), the effect dissolve in the between-subject variance! </span>
<span class="c">#therefor use MixedLM</span></code></pre></div><pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:              amplitude   R-squared:                       0.312
Model:                            OLS   Adj. R-squared:                  0.305
Method:                 Least Squares   F-statistic:                     43.38
Date:                Sat, 15 Aug 2015   Prob (F-statistic):           3.79e-23
Time:                        10:51:42   Log-Likelihood:                -1967.8
No. Observations:                 291   AIC:                             3944.
Df Residuals:                     287   BIC:                             3958.
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
=====================================================================================================
                                        coef    std err          t      P&gt;|t|      [95.0% Conf. Int.]
-----------------------------------------------------------------------------------------------------
Intercept                           238.6935     38.346      6.225      0.000       163.219   314.168
stimulus_type[T.Clicks]             -76.5944     59.868     -1.279      0.202      -194.431    41.242
intensity                             6.4898      0.770      8.427      0.000         4.974     8.006
stimulus_type[T.Clicks]:intensity    -1.8457      1.150     -1.605      0.110        -4.109     0.417
==============================================================================
Omnibus:                        2.872   Durbin-Watson:                   0.663
Prob(Omnibus):                  0.238   Jarque-Bera (JB):                2.756
Skew:                           0.238   Prob(JB):                        0.252
Kurtosis:                       3.008   Cond. No.                         320.
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
                                  sum_sq   df          F        PR(&gt;F)
stimulus_type             1927226.558883    1  43.434354  2.094849e-10
intensity                 4349489.911650    1  98.025468  4.505229e-20
stimulus_type:intensity    114352.377676    1   2.577186  1.095140e-01
Residual                 12734482.515712  287        NaN           NaN
</code></pre><p><strong>In [117]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">statsmodels.stats.multicomp</span> <span class="kn">import</span> <span class="n">pairwise_tukeyhsd</span>
<span class="k">print</span> <span class="n">pairwise_tukeyhsd</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="s">&#39;amplitude&#39;</span><span class="p">],</span> <span class="n">tmp</span><span class="p">[</span><span class="s">&#39;intensity&#39;</span><span class="p">])</span>
<span class="c">#print pairwise_tukeyhsd(data_bera[&#39;latency&#39;], data_bera[&#39;stimulus_type&#39;])</span></code></pre></div><pre><code> Multiple Comparison of Means - Tukey HSD,FWER=0.05
===================================================
group1 group2  meandiff   lower      upper   reject
---------------------------------------------------
  0      5      -110.0  -866.6536   646.6536 False 
  0      10      3.5    -566.0882   573.0882 False 
  0      15     -52.5   -979.2076   874.2076 False 
  0      20     109.5   -440.6093   659.6093 False 
  0      25     -72.5   -999.2076   854.2076 False 
  0      30    188.8889 -360.8072   738.585  False 
  0      35     -82.5   -773.2271   608.2271 False 
  0      40    255.2083 -290.8594   801.2761 False 
  0      45    -35.8333 -726.5604   654.8938 False 
  0      50    140.0926 -414.4045   694.5896 False 
  0      55     -62.5   -989.2076   864.2076 False 
  0      60    326.875  -219.1927   872.9427 False 
  0      70    307.6923 -247.5397   862.9243 False 
  0      80    430.6395 -116.6966   977.9757 False 
  5      10     113.5   -456.0882   683.0882 False 
  5      15      57.5   -869.2076   984.2076 False 
  5      20     219.5   -330.6093   769.6093 False 
  5      25      37.5   -889.2076   964.2076 False 
  5      30    298.8889 -250.8072   848.585  False 
  5      35      27.5   -663.2271   718.2271 False 
  5      40    365.2083 -180.8594   911.2761 False 
  5      45    74.1667  -616.5604   764.8938 False 
  5      50    250.0926 -304.4045   804.5896 False 
  5      55      47.5   -879.2076   974.2076 False 
  5      60    436.875  -109.1927   982.9427 False 
  5      70    417.6923 -137.5397   972.9243 False 
  5      80    540.6395  -6.6966   1087.9757 False 
  10     15     -56.0   -837.4685   725.4685 False 
  10     20     106.0   -127.5084   339.5084 False 
  10     25     -76.0   -857.4685   705.4685 False 
  10     30    185.3889  -47.1445   417.9223 False 
  10     35     -86.0   -564.5498   392.5498 False 
  10     40    251.7083  27.8872    475.5295  True 
  10     45    -39.3333 -517.8831   439.2164 False 
  10     50    136.5926  -107.073   380.2582 False 
  10     55     -66.0   -847.4685   715.4685 False 
  10     60    323.375   99.5538    547.1962  True 
  10     70    304.1923  58.8589    549.5257  True 
  10     80    427.1395  200.2412   654.0378  True 
  15     20     162.0   -605.3868   929.3868 False 
  15     25     -20.0   -1090.0698 1050.0698 False 
  15     30    241.3889 -525.7018  1008.4796 False 
  15     35     -30.0   -903.7083   843.7083 False 
  15     40    307.7083 -456.7865  1072.2031 False 
  15     45    16.6667  -857.0417   890.375  False 
  15     50    192.5926 -577.9457   963.1309 False 
  15     55     -10.0   -1080.0698 1060.0698 False 
  15     60    379.375  -385.1198  1143.8698 False 
  15     70    360.1923 -410.8751  1131.2597 False 
  15     80    483.1395 -282.2618  1248.5409 False 
  20     25     -182.0  -949.3868   585.3868 False 
  20     30    79.3889  -100.2255   259.0032 False 
  20     35     -192.0  -647.1916   263.1916 False 
  20     40    145.7083  -22.4744   313.8911 False 
  20     45   -145.3333  -600.525   309.8583 False 
  20     50    30.5926  -163.2178   224.403  False 
  20     55     -172.0  -939.3868   595.3868 False 
  20     60    217.375   49.1922    385.5578  True 
  20     70    198.1923   2.2892    394.0954  True 
  20     80    321.1395  148.8828   493.3963  True 
  25     30    261.3889 -505.7018  1028.4796 False 
  25     35     -10.0   -883.7083   863.7083 False 
  25     40    327.7083 -436.7865  1092.2031 False 
  25     45    36.6667  -837.0417   910.375  False 
  25     50    212.5926 -557.9457   983.1309 False 
  25     55      10.0   -1060.0698 1080.0698 False 
  25     60    399.375  -365.1198  1163.8698 False 
  25     70    380.1923 -390.8751  1151.2597 False 
  25     80    503.1395 -262.2618  1268.5409 False 
  30     35   -271.3889 -726.0811   183.3034 False 
  30     40    66.3194   -100.507   233.1459 False 
  30     45   -224.7222 -679.4145    229.97  False 
  30     50    -48.7963 -241.4309   143.8383 False 
  30     55   -251.3889 -1018.4796  515.7018 False 
  30     60    137.9861  -28.8403   304.8126 False 
  30     70    118.8034  -75.9365   313.5434 False 
  30     80    241.7506  70.8179    412.6834  True 
  35     40    337.7083 -112.5906   788.0073 False 
  35     45    46.6667  -571.1384   664.4718 False 
  35     50    222.5926 -237.8921   683.0773 False 
  35     55      20.0   -853.7083   893.7083 False 
  35     60    409.375   -40.924    859.674  False 
  35     70    390.1923  -71.1771   851.5617 False 
  35     80    513.1395  61.3032    964.9759  True 
  40     45   -291.0417 -741.3406   159.2573 False 
  40     50   -115.1157 -297.1383   66.9068  False 
  40     55   -317.7083 -1082.2031  446.7865 False 
  40     60    71.6667   -82.7846   226.1179 False 
  40     70     52.484  -131.7653   236.7332 False 
  40     80    175.4312  16.5535    334.3089  True 
  45     50    175.9259 -284.5588   636.4107 False 
  45     55    -26.6667  -900.375   847.0417 False 
  45     60    362.7083  -87.5906   813.0073 False 
  45     70    343.5256 -117.8438   804.8951 False 
  45     80    466.4729  14.6365    918.3092  True 
  50     55   -202.5926 -973.1309   567.9457 False 
  50     60    186.7824   4.7598    368.805   True 
  50     70    167.5997  -40.306    375.5055 False 
  50     80    290.5469  104.7537   476.3402  True 
  55     60    389.375  -375.1198  1153.8698 False 
  55     70    370.1923 -400.8751  1141.2597 False 
  55     80    493.1395 -272.2618  1258.5409 False 
  60     70    -19.1827 -203.4319   165.0665 False 
  60     80    103.7645  -55.1132   262.6422 False 
  70     80    122.9472  -65.0281   310.9225 False 
---------------------------------------------------
</code></pre><p><strong>In [117]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#ideas for plotting:</span>
<span class="c">#- plot amplitude Chirp against corresponding amplitude for Click</span>
<span class="c">#- plot amplitude Chirp against behavioral threshold (adults)</span></code></pre></div> <p><strong>In [124]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">tmp_grp_st</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">&#39;stimulus_type&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tmp_grp_st</span><span class="p">[</span><span class="s">&#39;stimulus_type&#39;</span><span class="o">==</span><span class="s">&#39;Chirps&#39;</span><span class="p">][</span><span class="s">&#39;amplitude&#39;</span><span class="p">],</span> <span class="n">tmp_grp_st</span><span class="p">[</span><span class="s">&#39;stimulus_type&#39;</span><span class="o">==</span><span class="s">&#39;Clicks&#39;</span><span class="p">][</span><span class="s">&#39;amplitude&#39;</span><span class="p">])</span></code></pre></div><pre><code>---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)

&lt;ipython-input-124-bcb0570427b0&gt; in &lt;module&gt;()
      1 tmp_grp_st = tmp.groupby('stimulus_type')
----&gt; 2 plt.plot(tmp_grp_st['stimulus_type'=='Chirps']['amplitude'], tmp_grp_st['stimulus_type'=='Clicks']['amplitude'])


/usr/local/lib/python2.7/site-packages/pandas/core/groupby.pyc in __getitem__(self, key)
   2900         else:
   2901             if key not in self.obj:
-&gt; 2902                 raise KeyError("Column not found: %s" % key)
   2903             # kind of a kludge
   2904             return SeriesGroupBy(self.obj[key], selection=key,


KeyError: 'Column not found: False'
</code></pre><p><strong>In [119]:</strong></p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;purple&#39;</span><span class="p">,</span> <span class="s">&#39;green&#39;</span><span class="p">]</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;o&#39;</span><span class="p">,</span> <span class="s">&#39;v&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">intensity</span><span class="p">,</span> <span class="n">stimulus</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s">&#39;Clicks&#39;</span><span class="p">],</span> <span class="n">group</span><span class="p">[</span><span class="s">&#39;Chirps&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">factors</span><span class="p">],</span>
    <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">[</span><span class="n">factors</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">12</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></code></pre></div><pre><code>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)

&lt;ipython-input-119-356500ad8845&gt; in &lt;module&gt;()
      2 markers = ['o', 'v']
      3 
----&gt; 4 for factors, group in tmp:
      5     plt.scatter(group['Clicks'], group['Chirps'], color=colors[factors],
      6     marker=markers[factors], s=12**2)


ValueError: too many values to unpack
</code></pre><p><strong>In []:</strong></p> </span> <div id="page-meta" class="t30"> <p> <!-- Look the author details up from the site config. --> <!-- Output author details if some exist. --> <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="pr20 icon-edit"><a href="https://crisly.github.io" target="_blank"> Cris Lanting</a></span> </span> <time class="icon-calendar pr20" datetime="2015-08-20" itemprop="datePublished"> 2015-08-20</time> <span class="icon-archive pr20"> PYTHON</span> <br> <span class="pr20"><span class="icon-price-tag pr10"> python</span> <span class="icon-price-tag pr10"> statsmodels</span> <span class="icon-price-tag pr10"> linear mixed-models</span> </span> </p> <div id="post-nav" class="row"> <div class="small-5 columns"><a class="button small radius prev" href="http://localhost:4000/python/python_data_analysis_and_visualisation/">&laquo; Python data analysis & visualisation</a></div><!-- /.small-4.columns --> <div class="small-2 columns text-center"><a class="radius button small" href="http://localhost:4000/blog/archive/" title="Blog Archive">Archive</a></div><!-- /.small-4.columns --> </div> </div><!-- /.page-meta --> </article> </div><!-- /.medium-8.columns --> </div><!-- /.row --> <div id="up-to-top" class="row"> <div class="small-12 columns" style="text-align: right;"> <a class="iconfont" href="#top-of-page">&#xf108;</a> </div><!-- /.small-12.columns --> </div><!-- /.row --> <footer id="footer-content" class="bg-grau"> <div id="footer"> <div class="row"> <div class="medium-6 large-5 columns"> <h5 class="shadow-black">About This Site</h5> <p class="shadow-black"> »Crisly's antics« is my personal webspace. About neuroscience, tinnitus, photos and more. <a href="http://localhost:4000/about/">More ›</a> </p> </div><!-- /.large-6.columns --> <div class="small-6 medium-3 large-3 large-offset-1 columns"> <h5 class="shadow-black">Various things</h5> <ul class="no-bullet shadow-black"> <li > <a href="http://localhost:4000" title=""></a> </li> <li class="services-contact" > <a href="http://localhost:4000/contact/" title="Contact">Contact</a> </li> <li class="rss-link" > <a href="http://localhost:4000/feed.xml" title="Subscribe to RSS">RSS</a> </li> <li class="sitemap-link" > <a href="http://localhost:4000/sitemap.xml" title="Sitemap for Google Webmastertools">sitemap.xml</a> </li> </ul> </div><!-- /.large-4.columns --> <div class="small-6 medium-3 large-3 columns"> <ul class="no-bullet shadow-black"> </ul> </div><!-- /.large-3.columns --> </div><!-- /.row --> </div><!-- /#footer --> <div id="subfooter"> <nav class="row"> <section id="subfooter-left" class="b30 small-12 medium-6 columns"> <ul class="inline-list"> <li>crisly.github.io is made with <a style="display:inline;" href="http://jekyllrb.com/" target="_blank">Jekyll</a> using <a style="display:inline;" href="http://phlow.github.io/feeling-responsive/">Feeling Responsive</a></li> </ul> </section> <section id="subfooter-right" class="small-12 medium-6 columns social-icons"> <ul class="inline-list"> <li><a href="https://twitter.com/crisly" target="_blank" class="icon-twitter" title="Random tweets and birdlike noises"></a></li> <li><a href="https://www.flickr.com/photos/crisly" target="_blank" class="icon-camera" title="Pics, photo's, images... you get the gist"></a></li> <li><a href="http://www.facebook.com/crisly" target="_blank" class="icon-facebook" title="Facebook - because we might be connected trough less than 6 degrees"></a></li> <li><a href="https://www.pinterest.com/crislanting/" target="_blank" class="icon-pinterest" title="Assorted links to photo's, art and stuff"></a></li> <li><a href="https://www.linkedin.com/profile/view?id=19761002" target="_blank" class="icon-linkedin" title="To link or not to link"></a></li> <li><a href="http://github.com/Crisly/" target="_blank" class="icon-github" title="Code and more..."></a></li> </ul> </section> </nav> </div><!-- /#subfooter --> </footer> <script src="http://localhost:4000/assets/js/javascript.min.js"></script> <script> $("#masthead").backstretch("http://localhost:4000/images/cornwall.jpg", {fade: 700}); $("#masthead-with-text").backstretch("http://localhost:4000/images/cornwall.jpg", {fade: 700}); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-66208950-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
